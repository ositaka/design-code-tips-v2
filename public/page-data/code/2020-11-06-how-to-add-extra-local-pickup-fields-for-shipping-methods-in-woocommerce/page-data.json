{
    "componentChunkName": "component---src-templates-code-post-js",
    "path": "/code/2020-11-06-how-to-add-extra-local-pickup-fields-for-shipping-methods-in-woocommerce/",
    "result": {"data":{"markdownRemark":{"id":"66c24383-9327-5435-8834-95ddaa2fd86e","html":"<p>This post is helpful if you want to add extra options on \"Local Pickup\" shipping methods. You must add this code on your <code>functions.php</code> file.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"php\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">/*  Custom Shipping (select local pick-up)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"> =============================================================== */</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// Custom function that handle your settings</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">carrier_settings</span><span class=\"mtk1\">(){</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk11\">array</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk8\">&#39;targeted_methods&#39;</span><span class=\"mtk1\"> =&gt; </span><span class=\"mtk11\">array</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;local_pickup:9&#39;</span><span class=\"mtk1\">,</span><span class=\"mtk8\">&#39;local_pickup:4&#39;</span><span class=\"mtk1\">), </span><span class=\"mtk3\">// Your targeted shipping method(s) in this array</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk8\">&#39;field_id&#39;</span><span class=\"mtk1\">         =&gt; </span><span class=\"mtk8\">&#39;carrier_name&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk3\">// Field Id</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk8\">&#39;field_type&#39;</span><span class=\"mtk1\">       =&gt; </span><span class=\"mtk8\">&#39;select&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk3\">// Field type</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk8\">&#39;field_label&#39;</span><span class=\"mtk1\">      =&gt; </span><span class=\"mtk8\">&#39;&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk3\">// Leave an empty value if the first option has a text (see below).</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk8\">&#39;label_name&#39;</span><span class=\"mtk1\">       =&gt; </span><span class=\"mtk11\">__</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Pickup location and time:&quot;</span><span class=\"mtk1\">,</span><span class=\"mtk8\">&quot;woocommerce&quot;</span><span class=\"mtk1\">), </span><span class=\"mtk3\">// for validation and as meta key for orders</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk8\">&#39;field_options&#39;</span><span class=\"mtk1\">    =&gt; </span><span class=\"mtk11\">array</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">             </span><span class=\"mtk3\">// The option displayed at first ( or keep an empty value &#39;&#39;,)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk11\">__</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Choose a local pickup and time&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;woocommerce&quot;</span><span class=\"mtk1\">),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk3\">// The carrier companies below (one by line)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk8\">&#39;Local pickup 1 — 12h-18h&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk8\">&#39;Local pickup 2 — 12h-18h&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk8\">&#39;Local pickup 3 — 12h-18h&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk8\">&#39;Local pickup 4 — 12h-18h&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        ),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// Display the custom checkout field</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">add_action</span><span class=\"mtk1\">( </span><span class=\"mtk8\">&#39;woocommerce_after_shipping_rate&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;carrier_company_custom_select_field&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk7\">20</span><span class=\"mtk1\">, </span><span class=\"mtk7\">2</span><span class=\"mtk1\"> );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">carrier_company_custom_select_field</span><span class=\"mtk1\">(</span><span class=\"mtk12\"> $method</span><span class=\"mtk1\">,</span><span class=\"mtk12\"> $index</span><span class=\"mtk1\"> ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">extract</span><span class=\"mtk1\">( </span><span class=\"mtk11\">carrier_settings</span><span class=\"mtk1\">() ); </span><span class=\"mtk3\">// Load settings and convert them in variables</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">$chosen</span><span class=\"mtk1\">  = </span><span class=\"mtk11\">WC</span><span class=\"mtk1\">()-&gt;</span><span class=\"mtk12\">session</span><span class=\"mtk1\">-&gt;</span><span class=\"mtk11\">get</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;chosen_shipping_methods&#39;</span><span class=\"mtk1\">); </span><span class=\"mtk3\">// The chosen methods</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">$value</span><span class=\"mtk1\">   = </span><span class=\"mtk11\">WC</span><span class=\"mtk1\">()-&gt;</span><span class=\"mtk12\">session</span><span class=\"mtk1\">-&gt;</span><span class=\"mtk11\">get</span><span class=\"mtk1\">(</span><span class=\"mtk12\">$field_id</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">$value</span><span class=\"mtk1\">   = </span><span class=\"mtk11\">WC</span><span class=\"mtk1\">()-&gt;</span><span class=\"mtk12\">session</span><span class=\"mtk1\">-&gt;</span><span class=\"mtk11\">__isset</span><span class=\"mtk1\">(</span><span class=\"mtk12\">$field_id</span><span class=\"mtk1\">) ? </span><span class=\"mtk12\">$value</span><span class=\"mtk1\"> : </span><span class=\"mtk11\">WC</span><span class=\"mtk1\">()-&gt;</span><span class=\"mtk12\">checkout</span><span class=\"mtk1\">-&gt;</span><span class=\"mtk11\">get_value</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;_&#39;</span><span class=\"mtk1\">.</span><span class=\"mtk12\">$field_id</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">$options</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">array</span><span class=\"mtk1\">(); </span><span class=\"mtk3\">// Initializing</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\">( ! </span><span class=\"mtk11\">empty</span><span class=\"mtk1\">(</span><span class=\"mtk12\">$chosen</span><span class=\"mtk1\">) &amp;&amp; </span><span class=\"mtk12\">$method</span><span class=\"mtk1\">-&gt;</span><span class=\"mtk12\">id</span><span class=\"mtk1\"> === </span><span class=\"mtk12\">$chosen</span><span class=\"mtk1\">[</span><span class=\"mtk12\">$index</span><span class=\"mtk1\">] &amp;&amp; </span><span class=\"mtk11\">in_array</span><span class=\"mtk1\">(</span><span class=\"mtk12\">$method</span><span class=\"mtk1\">-&gt;</span><span class=\"mtk12\">id</span><span class=\"mtk1\">, </span><span class=\"mtk12\">$targeted_methods</span><span class=\"mtk1\">)  ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">echo</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;&lt;div class=&quot;custom-carrier&quot;&gt;&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\">// Loop through field otions to add the correct keys</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">foreach</span><span class=\"mtk1\">( </span><span class=\"mtk12\">$field_options</span><span class=\"mtk1\"> as </span><span class=\"mtk12\">$key</span><span class=\"mtk1\"> =&gt; </span><span class=\"mtk12\">$option_value</span><span class=\"mtk1\"> ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">$option_key</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">$key</span><span class=\"mtk1\"> == </span><span class=\"mtk7\">0</span><span class=\"mtk1\"> ? </span><span class=\"mtk8\">&#39;&#39;</span><span class=\"mtk1\"> : </span><span class=\"mtk12\">$key</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">$options</span><span class=\"mtk1\">[</span><span class=\"mtk12\">$option_key</span><span class=\"mtk1\">] = </span><span class=\"mtk12\">$option_value</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">woocommerce_form_field</span><span class=\"mtk1\">( </span><span class=\"mtk12\">$field_id</span><span class=\"mtk1\">, </span><span class=\"mtk11\">array</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk8\">&#39;type&#39;</span><span class=\"mtk1\">     =&gt; </span><span class=\"mtk12\">$field_type</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk8\">&#39;label&#39;</span><span class=\"mtk1\">    =&gt; </span><span class=\"mtk8\">&#39;&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk3\">// Not required if the first option has a text.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk8\">&#39;class&#39;</span><span class=\"mtk1\">    =&gt; </span><span class=\"mtk11\">array</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;form-row-wide &#39;</span><span class=\"mtk1\"> . </span><span class=\"mtk12\">$field_id</span><span class=\"mtk1\"> . </span><span class=\"mtk8\">&#39;-&#39;</span><span class=\"mtk1\"> . </span><span class=\"mtk12\">$field_type</span><span class=\"mtk1\"> ),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk8\">&#39;required&#39;</span><span class=\"mtk1\"> =&gt; </span><span class=\"mtk4\">true</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk8\">&#39;options&#39;</span><span class=\"mtk1\">  =&gt; </span><span class=\"mtk12\">$options</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        ), </span><span class=\"mtk12\">$value</span><span class=\"mtk1\"> );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">echo</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;&lt;/div&gt;&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<pre class=\"grvsc-container default-dark\" data-language=\"php\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// jQuery code (client side) - Ajax sender</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">add_action</span><span class=\"mtk1\">( </span><span class=\"mtk8\">&#39;wp_footer&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;carrier_company_script_js&#39;</span><span class=\"mtk1\"> );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">carrier_company_script_js</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">// Only cart &amp; checkout pages</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\">( </span><span class=\"mtk11\">is_cart</span><span class=\"mtk1\">() || ( </span><span class=\"mtk11\">is_checkout</span><span class=\"mtk1\">() &amp;&amp; ! </span><span class=\"mtk11\">is_wc_endpoint_url</span><span class=\"mtk1\">() ) ):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">// Load settings and convert them in variables</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">extract</span><span class=\"mtk1\">( </span><span class=\"mtk11\">carrier_settings</span><span class=\"mtk1\">() );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">$js_variable</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">is_cart</span><span class=\"mtk1\">() ? </span><span class=\"mtk8\">&#39;wc_cart_params&#39;</span><span class=\"mtk1\"> : </span><span class=\"mtk8\">&#39;wc_checkout_params&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">// jQuery Ajax code</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    ?&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;script type=</span><span class=\"mtk8\">&quot;text/javascript&quot;</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">jQuery</span><span class=\"mtk1\">( </span><span class=\"mtk4\">function</span><span class=\"mtk1\">($){</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (typeof &lt;?php </span><span class=\"mtk11\">echo</span><span class=\"mtk1\"> </span><span class=\"mtk12\">$js_variable</span><span class=\"mtk1\">; ?&gt; === </span><span class=\"mtk8\">&#39;undefined&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">false</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        $(document.body).</span><span class=\"mtk11\">on</span><span class=\"mtk1\">( </span><span class=\"mtk8\">&#39;change&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;select#&lt;?php echo $field_id; ?&gt;&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk4\">function</span><span class=\"mtk1\">(){</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> value = $(this).</span><span class=\"mtk11\">val</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            $.</span><span class=\"mtk11\">ajax</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                type: </span><span class=\"mtk8\">&#39;POST&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                url: &lt;?php </span><span class=\"mtk11\">echo</span><span class=\"mtk1\"> </span><span class=\"mtk12\">$js_variable</span><span class=\"mtk1\">; ?&gt;.ajax_url,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                data: {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk8\">&#39;action&#39;</span><span class=\"mtk1\">: </span><span class=\"mtk8\">&#39;carrier_name&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk8\">&#39;value&#39;</span><span class=\"mtk1\">: value</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                success: </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> (result) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    console.</span><span class=\"mtk11\">log</span><span class=\"mtk1\">(result); </span><span class=\"mtk3\">// Only for testing (to be removed)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;/script&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    &lt;?php</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">endif</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// The Wordpress Ajax PHP receiver</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">add_action</span><span class=\"mtk1\">( </span><span class=\"mtk8\">&#39;wp_ajax_carrier_name&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;set_carrier_company_name&#39;</span><span class=\"mtk1\"> );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">add_action</span><span class=\"mtk1\">( </span><span class=\"mtk8\">&#39;wp_ajax_nopriv_carrier_name&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;set_carrier_company_name&#39;</span><span class=\"mtk1\"> );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">set_carrier_company_name</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> ( </span><span class=\"mtk11\">isset</span><span class=\"mtk1\">(</span><span class=\"mtk12\">$_POST</span><span class=\"mtk1\">[</span><span class=\"mtk8\">&#39;value&#39;</span><span class=\"mtk1\">]) ){</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\">// Load settings and convert them in variables</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">extract</span><span class=\"mtk1\">( </span><span class=\"mtk11\">carrier_settings</span><span class=\"mtk1\">() );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\">( </span><span class=\"mtk11\">empty</span><span class=\"mtk1\">(</span><span class=\"mtk12\">$_POST</span><span class=\"mtk1\">[</span><span class=\"mtk8\">&#39;value&#39;</span><span class=\"mtk1\">]) ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">$value</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">$label</span><span class=\"mtk1\"> = </span><span class=\"mtk8\">&#39;Empty&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        } </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">$value</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">$label</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">esc_attr</span><span class=\"mtk1\">( </span><span class=\"mtk12\">$_POST</span><span class=\"mtk1\">[</span><span class=\"mtk8\">&#39;value&#39;</span><span class=\"mtk1\">] );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\">// Update session variable</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">WC</span><span class=\"mtk1\">()-&gt;</span><span class=\"mtk12\">session</span><span class=\"mtk1\">-&gt;</span><span class=\"mtk11\">set</span><span class=\"mtk1\">( </span><span class=\"mtk12\">$field_id</span><span class=\"mtk1\">, </span><span class=\"mtk12\">$value</span><span class=\"mtk1\"> );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\">// Send back the data to javascript (json encoded)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">echo</span><span class=\"mtk1\"> </span><span class=\"mtk12\">$label</span><span class=\"mtk1\"> . </span><span class=\"mtk8\">&#39; | &#39;</span><span class=\"mtk1\"> . </span><span class=\"mtk12\">$field_options</span><span class=\"mtk1\">[</span><span class=\"mtk12\">$value</span><span class=\"mtk1\">];</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">die</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// Conditional function for validation</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">has_carrier_field</span><span class=\"mtk1\">(){</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">$settings</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">carrier_settings</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk11\">array_intersect</span><span class=\"mtk1\">(</span><span class=\"mtk11\">WC</span><span class=\"mtk1\">()-&gt;</span><span class=\"mtk12\">session</span><span class=\"mtk1\">-&gt;</span><span class=\"mtk11\">get</span><span class=\"mtk1\">( </span><span class=\"mtk8\">&#39;chosen_shipping_methods&#39;</span><span class=\"mtk1\"> ), </span><span class=\"mtk12\">$settings</span><span class=\"mtk1\">[</span><span class=\"mtk8\">&#39;targeted_methods&#39;</span><span class=\"mtk1\">]);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// Validate the custom selection field</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">add_action</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;woocommerce_checkout_process&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;carrier_company_checkout_validation&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">carrier_company_checkout_validation</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">// Load settings and convert them in variables</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">extract</span><span class=\"mtk1\">( </span><span class=\"mtk11\">carrier_settings</span><span class=\"mtk1\">() );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\">( </span><span class=\"mtk11\">has_carrier_field</span><span class=\"mtk1\">() &amp;&amp; </span><span class=\"mtk11\">isset</span><span class=\"mtk1\">( </span><span class=\"mtk12\">$_POST</span><span class=\"mtk1\">[</span><span class=\"mtk12\">$field_id</span><span class=\"mtk1\">] ) &amp;&amp; </span><span class=\"mtk11\">empty</span><span class=\"mtk1\">( </span><span class=\"mtk12\">$_POST</span><span class=\"mtk1\">[</span><span class=\"mtk12\">$field_id</span><span class=\"mtk1\">] ) )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">wc_add_notice</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk11\">sprintf</span><span class=\"mtk1\">( </span><span class=\"mtk11\">__</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Please select a %s as it is a required field.&quot;</span><span class=\"mtk1\">,</span><span class=\"mtk8\">&quot;woocommerce&quot;</span><span class=\"mtk1\">),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk8\">&#39;&lt;strong&gt;&#39;</span><span class=\"mtk1\"> . </span><span class=\"mtk12\">$label_name</span><span class=\"mtk1\"> . </span><span class=\"mtk8\">&#39;&lt;/strong&gt;&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        ), </span><span class=\"mtk8\">&quot;error&quot;</span><span class=\"mtk1\"> );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// Save custom field as order meta data</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">add_action</span><span class=\"mtk1\">( </span><span class=\"mtk8\">&#39;woocommerce_checkout_create_order&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;save_carrier_company_as_order_meta&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk7\">30</span><span class=\"mtk1\">, </span><span class=\"mtk7\">1</span><span class=\"mtk1\"> );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">save_carrier_company_as_order_meta</span><span class=\"mtk1\">(</span><span class=\"mtk12\"> $order</span><span class=\"mtk1\"> ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">// Load settings and convert them in variables</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">extract</span><span class=\"mtk1\">( </span><span class=\"mtk11\">carrier_settings</span><span class=\"mtk1\">() );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\">( </span><span class=\"mtk11\">has_carrier_field</span><span class=\"mtk1\">() &amp;&amp; </span><span class=\"mtk11\">isset</span><span class=\"mtk1\">( </span><span class=\"mtk12\">$_POST</span><span class=\"mtk1\">[</span><span class=\"mtk12\">$field_id</span><span class=\"mtk1\">] ) &amp;&amp; ! </span><span class=\"mtk11\">empty</span><span class=\"mtk1\">( </span><span class=\"mtk12\">$_POST</span><span class=\"mtk1\">[</span><span class=\"mtk12\">$field_id</span><span class=\"mtk1\">] ) ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">$order</span><span class=\"mtk1\">-&gt;</span><span class=\"mtk11\">update_meta_data</span><span class=\"mtk1\">( </span><span class=\"mtk8\">&#39;_&#39;</span><span class=\"mtk1\">.</span><span class=\"mtk12\">$field_id</span><span class=\"mtk1\">, </span><span class=\"mtk12\">$field_options</span><span class=\"mtk1\">[</span><span class=\"mtk11\">esc_attr</span><span class=\"mtk1\">(</span><span class=\"mtk12\">$_POST</span><span class=\"mtk1\">[</span><span class=\"mtk12\">$field_id</span><span class=\"mtk1\">])] );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">WC</span><span class=\"mtk1\">()-&gt;</span><span class=\"mtk12\">session</span><span class=\"mtk1\">-&gt;</span><span class=\"mtk11\">__unset</span><span class=\"mtk1\">( </span><span class=\"mtk12\">$field_id</span><span class=\"mtk1\"> ); </span><span class=\"mtk3\">// remove session variable</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// Display custom field in admin order pages</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">add_action</span><span class=\"mtk1\">( </span><span class=\"mtk8\">&#39;woocommerce_admin_order_data_after_shipping_address&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;admin_order_display_carrier_company&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk7\">30</span><span class=\"mtk1\">, </span><span class=\"mtk7\">1</span><span class=\"mtk1\"> );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">admin_order_display_carrier_company</span><span class=\"mtk1\">(</span><span class=\"mtk12\"> $order</span><span class=\"mtk1\"> ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">// Load settings and convert them in variables</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">extract</span><span class=\"mtk1\">( </span><span class=\"mtk11\">carrier_settings</span><span class=\"mtk1\">() );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">$carrier</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">$order</span><span class=\"mtk1\">-&gt;</span><span class=\"mtk11\">get_meta</span><span class=\"mtk1\">( </span><span class=\"mtk8\">&#39;_&#39;</span><span class=\"mtk1\">.</span><span class=\"mtk12\">$field_id</span><span class=\"mtk1\"> ); </span><span class=\"mtk3\">// Get carrier company</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\">( ! </span><span class=\"mtk11\">empty</span><span class=\"mtk1\">(</span><span class=\"mtk12\">$carrier</span><span class=\"mtk1\">) ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\">// Display</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">echo</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;&lt;p&gt;&lt;strong&gt;&#39;</span><span class=\"mtk1\"> . </span><span class=\"mtk12\">$label_name</span><span class=\"mtk1\"> . </span><span class=\"mtk8\">&#39;&lt;/strong&gt;: &#39;</span><span class=\"mtk1\"> . </span><span class=\"mtk12\">$carrier</span><span class=\"mtk1\"> . </span><span class=\"mtk8\">&#39;&lt;/p&gt;&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h2>Display carrier company after shipping line everywhere (orders and emails)</h2>\n<pre class=\"grvsc-container default-dark\" data-language=\"php\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// Display carrier company after shipping line everywhere (orders and emails)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">add_filter</span><span class=\"mtk1\">( </span><span class=\"mtk8\">&#39;woocommerce_get_order_item_totals&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;display_carrier_company_on_order_item_totals&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk7\">1000</span><span class=\"mtk1\">, </span><span class=\"mtk7\">3</span><span class=\"mtk1\"> );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">display_carrier_company_on_order_item_totals</span><span class=\"mtk1\">(</span><span class=\"mtk12\"> $total_rows</span><span class=\"mtk1\">,</span><span class=\"mtk12\"> $order</span><span class=\"mtk1\">,</span><span class=\"mtk12\"> $tax_display</span><span class=\"mtk1\"> ){</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">// Load settings and convert them in variables</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">extract</span><span class=\"mtk1\">( </span><span class=\"mtk11\">carrier_settings</span><span class=\"mtk1\">() );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">$carrier</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">$order</span><span class=\"mtk1\">-&gt;</span><span class=\"mtk11\">get_meta</span><span class=\"mtk1\">( </span><span class=\"mtk8\">&#39;_&#39;</span><span class=\"mtk1\">.</span><span class=\"mtk12\">$field_id</span><span class=\"mtk1\"> ); </span><span class=\"mtk3\">// Get carrier company</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\">( ! </span><span class=\"mtk11\">empty</span><span class=\"mtk1\">(</span><span class=\"mtk12\">$carrier</span><span class=\"mtk1\">) ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">$new_total_rows</span><span class=\"mtk1\"> = [];</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\">// Loop through order total rows</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">foreach</span><span class=\"mtk1\">( </span><span class=\"mtk12\">$total_rows</span><span class=\"mtk1\"> as </span><span class=\"mtk12\">$key</span><span class=\"mtk1\"> =&gt; </span><span class=\"mtk12\">$values</span><span class=\"mtk1\"> ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">$new_total_rows</span><span class=\"mtk1\">[</span><span class=\"mtk12\">$key</span><span class=\"mtk1\">] = </span><span class=\"mtk12\">$values</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk3\">// Inserting the carrier company under shipping method</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">if</span><span class=\"mtk1\">( </span><span class=\"mtk12\">$key</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39;shipping&#39;</span><span class=\"mtk1\"> ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">$new_total_rows</span><span class=\"mtk1\">[</span><span class=\"mtk12\">$field_id</span><span class=\"mtk1\">] = </span><span class=\"mtk11\">array</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk8\">&#39;label&#39;</span><span class=\"mtk1\"> =&gt; </span><span class=\"mtk12\">$label_name</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk8\">&#39;value&#39;</span><span class=\"mtk1\"> =&gt; </span><span class=\"mtk12\">$carrier</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">$new_total_rows</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">$total_rows</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>Source: <a href=\"https://stackoverflow.com/questions/63191513/extra-carrier-field-for-shipping-methods-in-woocommerce-cart-and-checkout\" target=\"_blank\" rel=\"noopener\">https://stackoverflow.com/questions/63191513/extra-carrier-field-for-shipping-methods-in-woocommerce-cart-and-checkout</a></p>\n<hr>\n<h2>Hide delivery section on checkout page, if the user chooses a \"local pickup\"</h2>\n<pre class=\"grvsc-container default-dark\" data-language=\"php\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// Hide delivery section on checkout page, if the user chooses a &quot;local pickup&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">add_action</span><span class=\"mtk1\">( </span><span class=\"mtk8\">&#39;woocommerce_after_checkout_form&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;disable_delivery_section_on_checkout_form&#39;</span><span class=\"mtk1\"> );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">disable_delivery_section_on_checkout_form</span><span class=\"mtk1\">(</span><span class=\"mtk12\"> $available_gateways</span><span class=\"mtk1\"> ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">   </span><span class=\"mtk3\">// Part 1: Hide shipping based on the static choice @ Cart</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">   </span><span class=\"mtk3\">// Note: &quot;.woocommerce-shipping-fields&quot; strictly depends on your theme</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">   </span><span class=\"mtk12\">$chosen_methods</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">WC</span><span class=\"mtk1\">()-&gt;</span><span class=\"mtk12\">session</span><span class=\"mtk1\">-&gt;</span><span class=\"mtk11\">get</span><span class=\"mtk1\">( </span><span class=\"mtk8\">&#39;chosen_shipping_methods&#39;</span><span class=\"mtk1\"> );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">   </span><span class=\"mtk12\">$chosen_shipping</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">$chosen_methods</span><span class=\"mtk1\">[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">];</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">   </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> ( </span><span class=\"mtk7\">0</span><span class=\"mtk1\"> === </span><span class=\"mtk11\">strpos</span><span class=\"mtk1\">( </span><span class=\"mtk12\">$chosen_shipping</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;local_pickup&#39;</span><span class=\"mtk1\"> ) ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">   ?&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      &lt;script type=</span><span class=\"mtk8\">&quot;text/javascript&quot;</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">         </span><span class=\"mtk11\">jQuery</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;.woocommerce-shipping-fields&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk11\">fadeOut</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      &lt;/script&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">   &lt;?php</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">   }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">   </span><span class=\"mtk3\">// Part 2: Hide shipping based on the dynamic choice @ Checkout</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">   </span><span class=\"mtk3\">// Note: &quot;.woocommerce-shipping-fields&quot; strictly depends on your theme</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">   ?&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      &lt;script type=</span><span class=\"mtk8\">&quot;text/javascript&quot;</span><span class=\"mtk1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">         </span><span class=\"mtk11\">jQuery</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;form.checkout&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk11\">on</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;change&#39;</span><span class=\"mtk1\">,</span><span class=\"mtk8\">&#39;input[name^=&quot;shipping_method&quot;]&#39;</span><span class=\"mtk1\">,</span><span class=\"mtk4\">function</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> val = </span><span class=\"mtk11\">jQuery</span><span class=\"mtk1\">( this ).</span><span class=\"mtk11\">val</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (val.</span><span class=\"mtk11\">match</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;^local_pickup&quot;</span><span class=\"mtk1\">)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                     </span><span class=\"mtk11\">jQuery</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;.woocommerce-shipping-fields&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk11\">fadeOut</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">               } </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">               </span><span class=\"mtk11\">jQuery</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;.woocommerce-shipping-fields&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk11\">fadeIn</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">         });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      &lt;/script&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">   &lt;?php</span></span></span></code></pre>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .default-dark .mtk3 { color: #6A9955; }\n  .default-dark .mtk4 { color: #569CD6; }\n  .default-dark .mtk1 { color: #D4D4D4; }\n  .default-dark .mtk11 { color: #DCDCAA; }\n  .default-dark .mtk15 { color: #C586C0; }\n  .default-dark .mtk8 { color: #CE9178; }\n  .default-dark .mtk7 { color: #B5CEA8; }\n  .default-dark .mtk12 { color: #9CDCFE; }\n  .default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","frontmatter":{"date":"November 06, 2020","title":"How to add extra \"Local Pickup\" fields for shipping methods in WooCommerce?\n","description":"Learn how to add extra fields’ options for the \"Local Pickup\" shipping methods on WooCommerce's Cart and Checkout page.\n","tags":["Web Development","WooCommerce"]}}},"pageContext":{"id":"66c24383-9327-5435-8834-95ddaa2fd86e"}},
    "staticQueryHashes": ["4080856488"]}