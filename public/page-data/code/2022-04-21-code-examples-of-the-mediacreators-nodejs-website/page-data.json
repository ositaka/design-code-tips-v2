{
    "componentChunkName": "component---src-templates-code-post-js",
    "path": "/code/2022-04-21-code-examples-of-the-mediacreators-nodejs-website/",
    "result": {"data":{"markdownRemark":{"id":"f708efa8-62b3-5218-a6bb-8cdd65756c9d","html":"<h2>1 — Internet Connection Examples (<code>4g</code> + <code>3g</code>/<code>slow-2g</code>)</h2>\n<p>On this chapter, we can find a few examples of code, thought to take the most advantage of the user's internet connection type. These connection types can vary from <code>4g</code>, <code>3g</code>, <code>2g</code> and <code>slow-2g</code>. For the sake of simplicity, we are going to ignore the <code>2g</code> one and use <code>slow-2g</code> instead, as it is the slowest internet connection (GPRS).</p>\n<p>Have in mind that, by default, Prismic already serves all the images with a reasonable quality/compression ratio. As a plus, it serves already all the images with a <code>.webp</code> and it converts <code>.gif</code> files to animated <code>.webp</code> files. The images end-up by having a good final file size served from Prismic.</p>\n<p>We use the <a href=\"https://pugjs.org/api/getting-started.html\" target=\"_blank\" rel=\"noopener\">PugJS</a> as template engine to make use of it's magic on serving dynamic data, with NodeJS. To achieve this, we set a JavaScript cookie on the <code>base.pug</code> file, after checking the user's connection type at the very beginning of the request. This \"internet connection check-test\" it runs every type the user navigates between pages.</p>\n<p>As a good example for this use case scenario is, for instance, on an indoor market, where the internet connection is not so good, and it's changing quite frequently between <code>3g</code> and <code>slow-2g</code>. With this approach, we can quickly serve more compressed images, that will take less time to be loaded. This will give a better experience to the user and will keep the user motivated to wait a bit more, but not give it up. We show a background color on all images, based on its main color, picked by hand, to keep the branding aspect in mind.</p>\n<h3>1.1 — Check user's internet connection type with JavaScript &#x26; serve the appropriated media files with ExpressJS</h3>\n<p>The following JavaScript code is executed on the <code>&#x3C;head></code> HTML element, right after the SEO metatags. This code snippet it will add to check the user's internet connection with the help of <code>navigator.connection?.effectiveType</code>.</p>\n<p>Browser compatibility: <strong>Chrome based browsers</strong> and <strong>Opera</strong> only. <a href=\"https://caniuse.com/?search=effectiveType\" target=\"_blank\" rel=\"noopener\">No support for Safari, Firefox and IE</a>. In case the browser doesn't support <code>navigator.connection.effectiveType</code> we will just serve the <code>4g</code> assets.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"pug\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">//- Check Internet Connection</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">//- on initial page load</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">script</span><span class=\"mtk1\">.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">document</span><span class=\"mtk1\">.</span><span class=\"mtk12\">cookie</span><span class=\"mtk1\"> = </span><span class=\"mtk8\">`connection=; expires = Thu, 01 Jan 1970 00:00:00 GMT`</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">document</span><span class=\"mtk1\">.</span><span class=\"mtk12\">cookie</span><span class=\"mtk1\"> = </span><span class=\"mtk8\">`connection=</span><span class=\"mtk4\">${</span><span class=\"mtk12\">navigator</span><span class=\"mtk1\">.</span><span class=\"mtk12\">connection</span><span class=\"mtk1\">?.</span><span class=\"mtk12\">effectiveType</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (!</span><span class=\"mtk12\">window</span><span class=\"mtk1\">.</span><span class=\"mtk12\">location</span><span class=\"mtk1\">.</span><span class=\"mtk12\">hash</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">// redirects the user,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">window</span><span class=\"mtk1\">.</span><span class=\"mtk12\">location</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">window</span><span class=\"mtk1\">.</span><span class=\"mtk12\">location</span><span class=\"mtk1\"> + </span><span class=\"mtk8\">&#39;#loaded&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">window</span><span class=\"mtk1\">.</span><span class=\"mtk12\">location</span><span class=\"mtk1\">.</span><span class=\"mtk11\">reload</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  } </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">history</span><span class=\"mtk1\">.</span><span class=\"mtk11\">pushState</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">document</span><span class=\"mtk1\">.</span><span class=\"mtk12\">title</span><span class=\"mtk1\">, </span><span class=\"mtk12\">window</span><span class=\"mtk1\">.</span><span class=\"mtk12\">location</span><span class=\"mtk1\">.</span><span class=\"mtk12\">pathname</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span></code></pre>\n<p>Now let's get use of this cookie <code>connection</code> from the client-side and serve the appropriated media (using ExpressJS as a server).</p>\n<p>This is the reference code of our <code>app.js</code> file:</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"pug\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">const</span><span class=\"mtk1\"> cookieSession = require(&#39;cookie-session&#39;);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">app</span><span class=\"mtk12\">.use</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">cookieSession({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">    name: &#39;session&#39;,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">    keys: [&#39;key1&#39;, &#39;key2&#39;],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">    maxAge: 15 * 60 * 1000, // 15 minutes</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">  })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">app</span><span class=\"mtk12\">.use</span><span class=\"mtk1\">(</span><span class=\"mtk12\">(req, res, next)</span><span class=\"mtk1\"> =&gt; {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">ua</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">UAParser</span><span class=\"mtk1\">(</span><span class=\"mtk12\">req</span><span class=\"mtk1\">.</span><span class=\"mtk12\">headers</span><span class=\"mtk1\">[</span><span class=\"mtk8\">&#39;user-agent&#39;</span><span class=\"mtk1\">]);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">res</span><span class=\"mtk1\">.</span><span class=\"mtk12\">locals</span><span class=\"mtk1\">.</span><span class=\"mtk12\">isDesktop</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">ua</span><span class=\"mtk1\">.</span><span class=\"mtk12\">device</span><span class=\"mtk1\">.</span><span class=\"mtk12\">type</span><span class=\"mtk1\"> === </span><span class=\"mtk4\">undefined</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">res</span><span class=\"mtk1\">.</span><span class=\"mtk12\">locals</span><span class=\"mtk1\">.</span><span class=\"mtk12\">isPhone</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">ua</span><span class=\"mtk1\">.</span><span class=\"mtk12\">device</span><span class=\"mtk1\">.</span><span class=\"mtk12\">type</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39;mobile&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">res</span><span class=\"mtk1\">.</span><span class=\"mtk12\">locals</span><span class=\"mtk1\">.</span><span class=\"mtk12\">isTablet</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">ua</span><span class=\"mtk1\">.</span><span class=\"mtk12\">device</span><span class=\"mtk1\">.</span><span class=\"mtk12\">type</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39;tablet&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">res</span><span class=\"mtk1\">.</span><span class=\"mtk12\">locals</span><span class=\"mtk1\">.</span><span class=\"mtk12\">Link</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">handleLinkResolver</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">res</span><span class=\"mtk1\">.</span><span class=\"mtk12\">locals</span><span class=\"mtk1\">.</span><span class=\"mtk12\">PrismicDOM</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">PrismicDOM</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">res</span><span class=\"mtk1\">.</span><span class=\"mtk12\">locals</span><span class=\"mtk1\">.</span><span class=\"mtk12\">connection</span><span class=\"mtk1\"> == </span><span class=\"mtk4\">undefined</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">req</span><span class=\"mtk1\">.</span><span class=\"mtk12\">headers</span><span class=\"mtk1\">.</span><span class=\"mtk12\">cookie</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">// returns an object with the cookies&#39; name as keys</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk11\">getAppCookies</span><span class=\"mtk1\"> = (</span><span class=\"mtk12\">req</span><span class=\"mtk1\">) </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk3\">// We extract the raw cookies from the request headers</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">rawCookies</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">req</span><span class=\"mtk1\">.</span><span class=\"mtk12\">headers</span><span class=\"mtk1\">.</span><span class=\"mtk12\">cookie</span><span class=\"mtk1\">.</span><span class=\"mtk11\">split</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;; &#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">parsedCookies</span><span class=\"mtk1\"> = {};</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">rawCookies</span><span class=\"mtk1\">.</span><span class=\"mtk11\">forEach</span><span class=\"mtk1\">((</span><span class=\"mtk12\">rawCookie</span><span class=\"mtk1\">) </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> </span><span class=\"mtk12\">parsedCookie</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">rawCookie</span><span class=\"mtk1\">.</span><span class=\"mtk11\">split</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;=&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">parsedCookies</span><span class=\"mtk1\">[</span><span class=\"mtk12\">parsedCookie</span><span class=\"mtk1\">[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">]] = </span><span class=\"mtk12\">parsedCookie</span><span class=\"mtk1\">[</span><span class=\"mtk7\">1</span><span class=\"mtk1\">];</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">parsedCookies</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    };</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">let</span><span class=\"mtk1\"> </span><span class=\"mtk12\">connection</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">getAppCookies</span><span class=\"mtk1\">(</span><span class=\"mtk12\">req</span><span class=\"mtk1\">, </span><span class=\"mtk12\">res</span><span class=\"mtk1\">)[</span><span class=\"mtk8\">&#39;connection&#39;</span><span class=\"mtk1\">];</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">res</span><span class=\"mtk1\">.</span><span class=\"mtk12\">locals</span><span class=\"mtk1\">.</span><span class=\"mtk12\">connection</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">connection</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">console</span><span class=\"mtk1\">.</span><span class=\"mtk11\">log</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;connect on the server&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">connection</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  } </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">res</span><span class=\"mtk1\">.</span><span class=\"mtk12\">locals</span><span class=\"mtk1\">.</span><span class=\"mtk12\">connection</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">req</span><span class=\"mtk1\">.</span><span class=\"mtk12\">body</span><span class=\"mtk1\">.</span><span class=\"mtk12\">connection</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">next</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">});</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">app</span><span class=\"mtk12\">.set</span><span class=\"mtk1\">(</span><span class=\"mtk12\">&#39;views&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">path.join(__dirname, &#39;views&#39;)</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">app</span><span class=\"mtk12\">.set</span><span class=\"mtk1\">(</span><span class=\"mtk12\">&#39;view</span><span class=\"mtk1\"> </span><span class=\"mtk12\">engine&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">&#39;pug&#39;</span><span class=\"mtk1\">);</span></span></span></code></pre>\n<h3>1.2 — Video example (with Image fallback)</h3>\n<p>The desired element on this media object is the HTML element <code>&#x3C;video></code> and is only served when the <strong>user</strong> is on a <code>4g</code> connection. In case the user is on a bad connection type, for instance <code>3g</code> or <code>slow-2g</code>, an <code>&#x3C;img></code> HTML element will be served.</p>\n<h4>Notes</h4>\n<ol>\n<li>\n<p>In order to get even a better performance, and page load speed, we are using <code>.replace('?auto=compress,format', '?q=30&#x26;auto=compress,format')</code> to request a 70% optimized image, from the image processor of Prismic: <a href=\"https://prismic.io/blog/prismic-image-optimization-imgix\" title=\"See official post on Prismic.io\" target=\"_blank\" rel=\"noopener\"><code>imgix</code></a>.</p>\n</li>\n<li>\n<p>For desktop devices, it is better to set a maximum size of 1200px wide, by using <code>&#x26;w=1200</code> at the end of the quality parameter from the previous point.</p>\n</li>\n<li>\n<p>For mobile devices, the default <code>width</code> of all the images are <strong>480px</strong>, because is higher than the default 360px screen phone's width. This is helpful, because it serves a better image for high DPI screens, without the need for using a <code>@2x</code> image. In our case, the most important is the overall <a href=\"https://design-code.tips/tags/performance/\" target=\"_blank\" rel=\"noopener\">Performance of the website</a>.</p>\n</li>\n</ol>\n<h4>Example code — Video on <code>4g</code> only</h4>\n<pre class=\"grvsc-container default-dark\" data-language=\"pug\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">figure</span><span class=\"mtk12\">.home__hero__media</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">picture</span><span class=\"mtk1\">(</span><span class=\"mtk12\">height</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">home</span><span class=\"mtk1\">.</span><span class=\"mtk12\">data</span><span class=\"mtk1\">.</span><span class=\"mtk12\">video</span><span class=\"mtk1\">[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">].</span><span class=\"mtk12\">video_preview</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dimensions</span><span class=\"mtk1\">.</span><span class=\"mtk12\">height</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\"> </span><span class=\"mtk12\">width</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">home</span><span class=\"mtk1\">.</span><span class=\"mtk12\">data</span><span class=\"mtk1\">.</span><span class=\"mtk12\">video</span><span class=\"mtk1\">[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">].</span><span class=\"mtk12\">video_preview</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dimensions</span><span class=\"mtk1\">.</span><span class=\"mtk12\">width</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\"> </span><span class=\"mtk12\">style</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`background-color: </span><span class=\"mtk4\">${</span><span class=\"mtk12\">home</span><span class=\"mtk1\">.</span><span class=\"mtk12\">data</span><span class=\"mtk1\">.</span><span class=\"mtk12\">video</span><span class=\"mtk1\">[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">].</span><span class=\"mtk12\">background_color</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">connection</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39;4g&#39;</span><span class=\"mtk1\"> || </span><span class=\"mtk12\">connection</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39;undefined&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">video</span><span class=\"mtk1\">(</span><span class=\"mtk12\">preload</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;auto&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">playsinline</span><span class=\"mtk1\"> </span><span class=\"mtk12\">loop</span><span class=\"mtk1\"> </span><span class=\"mtk12\">muted</span><span class=\"mtk1\"> </span><span class=\"mtk12\">disablepictureinpicture</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">srcset</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">          </span><span class=\"mtk4\">${</span><span class=\"mtk12\">home</span><span class=\"mtk1\">.</span><span class=\"mtk12\">data</span><span class=\"mtk1\">.</span><span class=\"mtk12\">video</span><span class=\"mtk1\">[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">].</span><span class=\"mtk12\">video_mobile</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk4\">}</span><span class=\"mtk8\"> 768w,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">          </span><span class=\"mtk4\">${</span><span class=\"mtk12\">home</span><span class=\"mtk1\">.</span><span class=\"mtk12\">data</span><span class=\"mtk1\">.</span><span class=\"mtk12\">video</span><span class=\"mtk1\">[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">].</span><span class=\"mtk12\">video_desktop</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk4\">}</span><span class=\"mtk8\"> 769w</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        `</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">else</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">typeof</span><span class=\"mtk1\">(</span><span class=\"mtk12\">home</span><span class=\"mtk1\">.</span><span class=\"mtk12\">data</span><span class=\"mtk1\">.</span><span class=\"mtk12\">video</span><span class=\"mtk1\">[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">].</span><span class=\"mtk12\">video_preview</span><span class=\"mtk1\">.</span><span class=\"mtk12\">phone</span><span class=\"mtk1\">) !== </span><span class=\"mtk8\">&#39;undefined&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">source</span><span class=\"mtk1\">(</span><span class=\"mtk12\">media</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&#39;(max-width: 768px)&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">srcset</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">home</span><span class=\"mtk1\">.</span><span class=\"mtk12\">data</span><span class=\"mtk1\">.</span><span class=\"mtk12\">video</span><span class=\"mtk1\">[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">].</span><span class=\"mtk12\">video_preview</span><span class=\"mtk1\">.</span><span class=\"mtk12\">phone</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk1\">.</span><span class=\"mtk11\">replace</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;?auto=compress,format&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;?q=30&amp;auto=compress,format&#39;</span><span class=\"mtk1\">)</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">source</span><span class=\"mtk1\">(</span><span class=\"mtk12\">media</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&#39;(min-width: 769px)&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">srcset</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">home</span><span class=\"mtk1\">.</span><span class=\"mtk12\">data</span><span class=\"mtk1\">.</span><span class=\"mtk12\">video</span><span class=\"mtk1\">[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">].</span><span class=\"mtk12\">video_preview</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk1\">.</span><span class=\"mtk11\">replace</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;?auto=compress,format&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;?q=30&amp;w=1200&amp;auto=compress,format&#39;</span><span class=\"mtk1\">)</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">img</span><span class=\"mtk1\">(</span><span class=\"mtk12\">alt</span><span class=\"mtk1\">=</span><span class=\"mtk12\">home</span><span class=\"mtk1\">.</span><span class=\"mtk12\">data</span><span class=\"mtk1\">.</span><span class=\"mtk12\">video</span><span class=\"mtk1\">[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">].</span><span class=\"mtk12\">video_preview</span><span class=\"mtk1\">.</span><span class=\"mtk12\">alt</span><span class=\"mtk1\"> </span><span class=\"mtk12\">data-src</span><span class=\"mtk1\">=</span><span class=\"mtk12\">home</span><span class=\"mtk1\">.</span><span class=\"mtk12\">data</span><span class=\"mtk1\">.</span><span class=\"mtk12\">video</span><span class=\"mtk1\">[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">].</span><span class=\"mtk12\">video_preview</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk1\"> </span><span class=\"mtk12\">height</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">home</span><span class=\"mtk1\">.</span><span class=\"mtk12\">data</span><span class=\"mtk1\">.</span><span class=\"mtk12\">video</span><span class=\"mtk1\">[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">].</span><span class=\"mtk12\">video_preview</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dimensions</span><span class=\"mtk1\">.</span><span class=\"mtk12\">height</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\"> </span><span class=\"mtk12\">width</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">home</span><span class=\"mtk1\">.</span><span class=\"mtk12\">data</span><span class=\"mtk1\">.</span><span class=\"mtk12\">video</span><span class=\"mtk1\">[</span><span class=\"mtk7\">0</span><span class=\"mtk1\">].</span><span class=\"mtk12\">video_preview</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dimensions</span><span class=\"mtk1\">.</span><span class=\"mtk12\">width</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<h4>Example code — Media can be a <code>&#x3C;video></code> element or a <code>&#x3C;img></code> element. Then, check the user's internet connection to serve video or image</h4>\n<pre class=\"grvsc-container default-dark\" data-language=\"pug\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">figure</span><span class=\"mtk12\">.work_page__full-screen__media</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">picture</span><span class=\"mtk1\">(</span><span class=\"mtk12\">height</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dimensions</span><span class=\"mtk1\">.</span><span class=\"mtk12\">height</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\"> </span><span class=\"mtk12\">width</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dimensions</span><span class=\"mtk1\">.</span><span class=\"mtk12\">width</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\"> </span><span class=\"mtk12\">style</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`background-color: </span><span class=\"mtk4\">${</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">background_color</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">    //- is video &amp;&amp; is on 4g</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">is_video</span><span class=\"mtk1\"> === </span><span class=\"mtk4\">true</span><span class=\"mtk1\"> &amp;&amp; (</span><span class=\"mtk12\">connection</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39;4g&#39;</span><span class=\"mtk1\"> || </span><span class=\"mtk12\">connection</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39;undefined&#39;</span><span class=\"mtk1\">))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">video</span><span class=\"mtk1\">(</span><span class=\"mtk12\">preload</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;auto&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">playsinline</span><span class=\"mtk1\"> </span><span class=\"mtk12\">loop</span><span class=\"mtk1\"> </span><span class=\"mtk12\">muted</span><span class=\"mtk1\"> </span><span class=\"mtk12\">disablepictureinpicture</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">srcset</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">          </span><span class=\"mtk4\">${</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">video_mobile</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk4\">}</span><span class=\"mtk8\"> 768w,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">          </span><span class=\"mtk4\">${</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">video_desktop</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk4\">}</span><span class=\"mtk8\"> 769w</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        `</span><span class=\"mtk1\"> </span><span class=\"mtk12\">style</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`background-color: </span><span class=\"mtk4\">${</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">background_color</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">    //- is video &amp;&amp; is not on 4g: show image</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">else if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">is_video</span><span class=\"mtk1\"> === </span><span class=\"mtk4\">true</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">connection</span><span class=\"mtk1\"> !== </span><span class=\"mtk8\">&#39;4g&#39;</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk4\">typeof</span><span class=\"mtk1\">(</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">phone</span><span class=\"mtk1\">) !== </span><span class=\"mtk8\">&#39;undefined&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">source</span><span class=\"mtk1\">(</span><span class=\"mtk12\">media</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&#39;(max-width: 768px)&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">srcset</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">phone</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk1\">.</span><span class=\"mtk11\">replace</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;?auto=compress,format&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;?q=30&amp;auto=compress,format&#39;</span><span class=\"mtk1\">)</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">source</span><span class=\"mtk1\">(</span><span class=\"mtk12\">media</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&#39;(min-width: 769px)&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">srcset</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk1\">.</span><span class=\"mtk11\">replace</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;?auto=compress,format&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;?q=30&amp;w=1200&amp;auto=compress,format&#39;</span><span class=\"mtk1\">)</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">img</span><span class=\"mtk1\">(</span><span class=\"mtk12\">alt</span><span class=\"mtk1\">=</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">alt</span><span class=\"mtk1\"> </span><span class=\"mtk12\">data-src</span><span class=\"mtk1\">=</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk1\"> </span><span class=\"mtk12\">height</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dimensions</span><span class=\"mtk1\">.</span><span class=\"mtk12\">height</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\"> </span><span class=\"mtk12\">width</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dimensions</span><span class=\"mtk1\">.</span><span class=\"mtk12\">width</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">    //- is image</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">else</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">typeof</span><span class=\"mtk1\">(</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">phone</span><span class=\"mtk1\">) !== </span><span class=\"mtk8\">&#39;undefined&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">source</span><span class=\"mtk1\">(</span><span class=\"mtk12\">media</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&#39;(max-width: 768px)&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">srcset</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">connection</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39;4g&#39;</span><span class=\"mtk1\"> || </span><span class=\"mtk12\">connection</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39;undefined&#39;</span><span class=\"mtk1\"> ? </span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">phone</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk1\"> : </span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">phone</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk1\">.</span><span class=\"mtk11\">replace</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;?auto=compress,format&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;?q=30&amp;auto=compress,format&#39;</span><span class=\"mtk1\">)</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">source</span><span class=\"mtk1\">(</span><span class=\"mtk12\">media</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&#39;(min-width: 769px)&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">srcset</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">connection</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39;4g&#39;</span><span class=\"mtk1\"> || </span><span class=\"mtk12\">connection</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39;undefined&#39;</span><span class=\"mtk1\"> ? </span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk1\">.</span><span class=\"mtk11\">replace</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;?auto=compress,format&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;&#39;</span><span class=\"mtk1\">) : </span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk1\">.</span><span class=\"mtk11\">replace</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;?auto=compress,format&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;?q=30&amp;w=1200&amp;auto=compress,format&#39;</span><span class=\"mtk1\">)</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">img</span><span class=\"mtk1\">(</span><span class=\"mtk12\">alt</span><span class=\"mtk1\">=</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">alt</span><span class=\"mtk1\"> </span><span class=\"mtk12\">data-src</span><span class=\"mtk1\">=</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk1\">.</span><span class=\"mtk11\">replace</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;?auto=compress,format&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;&#39;</span><span class=\"mtk1\">) </span><span class=\"mtk12\">height</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dimensions</span><span class=\"mtk1\">.</span><span class=\"mtk12\">height</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\"> </span><span class=\"mtk12\">width</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dimensions</span><span class=\"mtk1\">.</span><span class=\"mtk12\">width</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<h3>1.3 — Image example (<code>4g</code> vs <code>3g</code>/<code>slow-2g</code>)</h3>\n<p>Ideally, with <code>4g</code>, we serve a more sharped image (without any compression) and we use <code>.replace('?auto=compress,format', '')</code> to replace the default auto-compressed file from Prismic's CDN (with <a href=\"https://prismic.io/blog/prismic-image-optimization-imgix\" title=\"See official post on Prismic.io\" target=\"_blank\" rel=\"noopener\"><code>imgix</code></a>).</p>\n<p>If the user is on a bad connection (<code>3g</code> or <code>slow-2g</code>), we serve a 70% optimized image from the request to the Prismic CDN (with <a href=\"https://prismic.io/blog/prismic-image-optimization-imgix\" title=\"See official post on Prismic.io\" target=\"_blank\" rel=\"noopener\"><code>imgix</code></a>).</p>\n<h4>Example code — Sharper images on <code>4g</code></h4>\n<pre class=\"grvsc-container default-dark\" data-language=\"pug\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">figure</span><span class=\"mtk12\">.home__projects__item__media</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">picture</span><span class=\"mtk1\">(</span><span class=\"mtk12\">height</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">project_image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dimensions</span><span class=\"mtk1\">.</span><span class=\"mtk12\">height</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\"> </span><span class=\"mtk12\">width</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">project_image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dimensions</span><span class=\"mtk1\">.</span><span class=\"mtk12\">width</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\"> </span><span class=\"mtk12\">style</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`background-color: </span><span class=\"mtk4\">${</span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">background_color</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">typeof</span><span class=\"mtk1\">(</span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">project_image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">phone</span><span class=\"mtk1\">) !== </span><span class=\"mtk8\">&#39;undefined&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">source</span><span class=\"mtk1\">(</span><span class=\"mtk12\">media</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&#39;(max-width: 768px)&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">srcset</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">connection</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39;4g&#39;</span><span class=\"mtk1\"> || </span><span class=\"mtk12\">connection</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39;undefined&#39;</span><span class=\"mtk1\"> ? </span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">project_image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">phone</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk1\"> : </span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">project_image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">phone</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk1\">.</span><span class=\"mtk11\">replace</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;?auto=compress,format&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;?q=30&amp;auto=compress,format&#39;</span><span class=\"mtk1\">)</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">source</span><span class=\"mtk1\">(</span><span class=\"mtk12\">media</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&#39;(min-width: 769px)&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">srcset</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">connection</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39;4g&#39;</span><span class=\"mtk1\"> || </span><span class=\"mtk12\">connection</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39;undefined&#39;</span><span class=\"mtk1\"> ? </span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">project_image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk1\">.</span><span class=\"mtk11\">replace</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;?auto=compress,format&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;&#39;</span><span class=\"mtk1\">) : </span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">project_image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk1\">.</span><span class=\"mtk11\">replace</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;?auto=compress,format&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;?q=30&amp;w=1200&amp;auto=compress,format&#39;</span><span class=\"mtk1\">)</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">img</span><span class=\"mtk12\">.home__projects__item__media__image</span><span class=\"mtk1\">(</span><span class=\"mtk12\">alt</span><span class=\"mtk1\">=</span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">project_image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">alt</span><span class=\"mtk1\"> </span><span class=\"mtk12\">data-src</span><span class=\"mtk1\">=</span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">project_image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk1\">.</span><span class=\"mtk11\">replace</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;?auto=compress,format&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&#39;&#39;</span><span class=\"mtk1\">) </span><span class=\"mtk12\">height</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">project_image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dimensions</span><span class=\"mtk1\">.</span><span class=\"mtk12\">height</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\"> </span><span class=\"mtk12\">width</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">project_image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dimensions</span><span class=\"mtk1\">.</span><span class=\"mtk12\">width</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span></code></pre>\n<h3>1.4 — Simple Image Example (desktop &#x26; phone)</h3>\n<p>Here is a simple image example, but still, we make sure we serve the right format size for mobile devices as well as for desktops. We double-check the internet connection type; if it is <code>4g</code>, we serve a more sharp/detailed image.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"pug\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">figure</span><span class=\"mtk12\">.services__projects__item__media</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">picture</span><span class=\"mtk1\">(</span><span class=\"mtk12\">height</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">project_image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dimensions</span><span class=\"mtk1\">.</span><span class=\"mtk12\">height</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\"> </span><span class=\"mtk12\">width</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">project_image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dimensions</span><span class=\"mtk1\">.</span><span class=\"mtk12\">width</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\"> </span><span class=\"mtk12\">style</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`background-color: </span><span class=\"mtk4\">${</span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">background_color</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">img</span><span class=\"mtk12\">.services__projects__item__media__image</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">alt</span><span class=\"mtk1\">=</span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">project_image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">alt</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">data-src</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">        </span><span class=\"mtk4\">${</span><span class=\"mtk12\">connection</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39;4g&#39;</span><span class=\"mtk1\"> || </span><span class=\"mtk12\">connection</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39;undefined&#39;</span><span class=\"mtk1\"> ?</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">project_image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk1\">.</span><span class=\"mtk11\">replace</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;?auto=compress,format&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">isPhone</span><span class=\"mtk1\"> ? </span><span class=\"mtk8\">&#39;?w=480&#39;</span><span class=\"mtk1\"> : </span><span class=\"mtk8\">&#39;?w=900&#39;</span><span class=\"mtk1\"> )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        :</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">project_image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk1\">.</span><span class=\"mtk11\">replace</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;?auto=compress,format&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">isPhone</span><span class=\"mtk1\"> ? </span><span class=\"mtk8\">&#39;?q=30&amp;w=360&amp;auto=compress,format&#39;</span><span class=\"mtk1\"> : </span><span class=\"mtk8\">&#39;?q=30&amp;w=600&amp;auto=compress,format&#39;</span><span class=\"mtk1\">)</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">height</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">project_image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dimensions</span><span class=\"mtk1\">.</span><span class=\"mtk12\">height</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">width</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">project</span><span class=\"mtk1\">.</span><span class=\"mtk12\">project_image</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dimensions</span><span class=\"mtk1\">.</span><span class=\"mtk12\">width</span><span class=\"mtk4\">}</span><span class=\"mtk8\">`</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<h2>2 — Responsive Video with JavaScript</h2>\n<p>On this chapter will take a quick look on how to be able to mimic the <strong>responsive image</strong> aspect, but on video. We can achieve this by using a <code>&#x3C;video></code> HTML element with a <code>data-src</code> data-attribute.</p>\n<h3>2.1 — Responsive Video Code — JavaScript</h3>\n<pre class=\"grvsc-container default-dark\" data-language=\"js\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// responsive video</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">responsiveVideo</span><span class=\"mtk1\">(</span><span class=\"mtk12\">window</span><span class=\"mtk1\">, </span><span class=\"mtk12\">undefined</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">videoSourceSet</span><span class=\"mtk1\">(</span><span class=\"mtk12\">options</span><span class=\"mtk1\">, </span><span class=\"mtk12\">elements</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">options</span><span class=\"mtk1\"> = </span><span class=\"mtk10\">Object</span><span class=\"mtk1\">.</span><span class=\"mtk11\">assign</span><span class=\"mtk1\">({}, { </span><span class=\"mtk12\">resize:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">false</span><span class=\"mtk1\">, </span><span class=\"mtk12\">resizeDelay:</span><span class=\"mtk1\"> </span><span class=\"mtk7\">50</span><span class=\"mtk1\"> }, </span><span class=\"mtk12\">options</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">elements</span><span class=\"mtk1\"> === </span><span class=\"mtk4\">undefined</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">elements</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">document</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getElementsByTagName</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;video&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">regex</span><span class=\"mtk1\"> =</span><span class=\"mtk5\"> /</span><span class=\"mtk11\">^</span><span class=\"mtk5\">\\s</span><span class=\"mtk6\">*</span><span class=\"mtk8\">(</span><span class=\"mtk5\">.</span><span class=\"mtk6\">+</span><span class=\"mtk8\">)</span><span class=\"mtk5\">\\s</span><span class=\"mtk6\">+</span><span class=\"mtk8\">(</span><span class=\"mtk5\">\\d</span><span class=\"mtk6\">+</span><span class=\"mtk8\">)([</span><span class=\"mtk5\">wh</span><span class=\"mtk8\">])</span><span class=\"mtk6\">?</span><span class=\"mtk5\">\\s</span><span class=\"mtk6\">*</span><span class=\"mtk11\">$</span><span class=\"mtk5\">/</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">getSourceSets</span><span class=\"mtk1\">(</span><span class=\"mtk12\">def</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">sources</span><span class=\"mtk1\"> = [];</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">parts</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">def</span><span class=\"mtk1\">.</span><span class=\"mtk11\">split</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;,&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk12\">parts</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">result</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> ((</span><span class=\"mtk12\">result</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">parts</span><span class=\"mtk1\">[</span><span class=\"mtk12\">i</span><span class=\"mtk1\">].</span><span class=\"mtk11\">match</span><span class=\"mtk1\">(</span><span class=\"mtk12\">regex</span><span class=\"mtk1\">))) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk12\">sources</span><span class=\"mtk1\">.</span><span class=\"mtk11\">push</span><span class=\"mtk1\">({ </span><span class=\"mtk12\">width:</span><span class=\"mtk1\"> </span><span class=\"mtk11\">parseInt</span><span class=\"mtk1\">(</span><span class=\"mtk12\">result</span><span class=\"mtk1\">[</span><span class=\"mtk7\">2</span><span class=\"mtk1\">]), </span><span class=\"mtk12\">src:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">result</span><span class=\"mtk1\">[</span><span class=\"mtk7\">1</span><span class=\"mtk1\">] });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">sources</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">selectSource</span><span class=\"mtk1\">(</span><span class=\"mtk12\">srcsrt</span><span class=\"mtk1\">, </span><span class=\"mtk12\">screenWidth</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">sources</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">getSourceSets</span><span class=\"mtk1\">(</span><span class=\"mtk12\">srcsrt</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">selectedDiff</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">null</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">source</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">null</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk12\">sources</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">candidate</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">sources</span><span class=\"mtk1\">[</span><span class=\"mtk12\">i</span><span class=\"mtk1\">];</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">candidateDiff</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">candidate</span><span class=\"mtk1\">.</span><span class=\"mtk12\">width</span><span class=\"mtk1\"> - </span><span class=\"mtk12\">screenWidth</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk12\">source</span><span class=\"mtk1\"> === </span><span class=\"mtk4\">null</span><span class=\"mtk1\"> ||</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          (</span><span class=\"mtk12\">selectedDiff</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk7\">0</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">candidateDiff</span><span class=\"mtk1\"> &gt;= </span><span class=\"mtk7\">0</span><span class=\"mtk1\">) ||</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          (</span><span class=\"mtk12\">candidateDiff</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk7\">0</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">candidateDiff</span><span class=\"mtk1\"> &gt; </span><span class=\"mtk12\">selectedDiff</span><span class=\"mtk1\">) ||</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          (</span><span class=\"mtk12\">candidateDiff</span><span class=\"mtk1\"> &gt;= </span><span class=\"mtk7\">0</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">candidateDiff</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">selectedDiff</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk12\">selectedDiff</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">candidateDiff</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk12\">source</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">candidate</span><span class=\"mtk1\">.</span><span class=\"mtk12\">src</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">source</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> </span><span class=\"mtk11\">init</span><span class=\"mtk1\">(</span><span class=\"mtk12\">elements</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\"> &lt; </span><span class=\"mtk12\">elements</span><span class=\"mtk1\">.</span><span class=\"mtk12\">length</span><span class=\"mtk1\">; </span><span class=\"mtk12\">i</span><span class=\"mtk1\">++) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">element</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">elements</span><span class=\"mtk1\">[</span><span class=\"mtk12\">i</span><span class=\"mtk1\">];</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">element</span><span class=\"mtk1\">.</span><span class=\"mtk12\">tagName</span><span class=\"mtk1\"> == </span><span class=\"mtk8\">&#39;VIDEO&#39;</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">element</span><span class=\"mtk1\">.</span><span class=\"mtk11\">hasAttribute</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;srcset&#39;</span><span class=\"mtk1\">)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">srcset</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">element</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getAttribute</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;srcset&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">srcset</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">selectedSource</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">selectSource</span><span class=\"mtk1\">(</span><span class=\"mtk12\">srcset</span><span class=\"mtk1\">, </span><span class=\"mtk12\">window</span><span class=\"mtk1\">.</span><span class=\"mtk12\">innerWidth</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">selectedSource</span><span class=\"mtk1\"> !== </span><span class=\"mtk12\">element</span><span class=\"mtk1\">.</span><span class=\"mtk12\">src</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">              </span><span class=\"mtk12\">element</span><span class=\"mtk1\">.</span><span class=\"mtk12\">src</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">selectedSource</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">              </span><span class=\"mtk3\">// fix intersecObserver</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">              </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">playPromise</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">element</span><span class=\"mtk1\">.</span><span class=\"mtk11\">play</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">              </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">playPromise</span><span class=\"mtk1\"> !== </span><span class=\"mtk4\">undefined</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">playPromise</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                  .</span><span class=\"mtk11\">then</span><span class=\"mtk1\">((</span><span class=\"mtk12\">_</span><span class=\"mtk1\">) </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk12\">element</span><span class=\"mtk1\">.</span><span class=\"mtk11\">pause</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                  })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                  .</span><span class=\"mtk11\">catch</span><span class=\"mtk1\">((</span><span class=\"mtk12\">error</span><span class=\"mtk1\">) </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk12\">error</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">null</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                  });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">              }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">init</span><span class=\"mtk1\">(</span><span class=\"mtk12\">elements</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">options</span><span class=\"mtk1\">.</span><span class=\"mtk12\">resize</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">resizeDelayTimeout</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">null</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">window</span><span class=\"mtk1\">.</span><span class=\"mtk11\">addEventListener</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;resize&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk4\">function</span><span class=\"mtk1\"> () {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">resizeDelayTimeout</span><span class=\"mtk1\"> !== </span><span class=\"mtk4\">null</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk11\">clearTimeout</span><span class=\"mtk1\">(</span><span class=\"mtk12\">resizeDelayTimeout</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">resizeDelayTimeout</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">setTimeout</span><span class=\"mtk1\">(</span><span class=\"mtk4\">function</span><span class=\"mtk1\"> () {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk11\">init</span><span class=\"mtk1\">(</span><span class=\"mtk12\">elements</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }, </span><span class=\"mtk12\">options</span><span class=\"mtk1\">.</span><span class=\"mtk12\">resizeDelay</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">window</span><span class=\"mtk1\">.</span><span class=\"mtk12\">videoSourceSet</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">videoSourceSet</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">responsiveVideo</span><span class=\"mtk1\">(</span><span class=\"mtk12\">window</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">videoSourceSet</span><span class=\"mtk1\">({ </span><span class=\"mtk12\">resize:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">, </span><span class=\"mtk12\">resizeDelay:</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1000</span><span class=\"mtk1\"> });</span></span></span></code></pre>\n<h3>2.2 — Responsive Video Code — PugJS &#x26; HTML</h3>\n<p>In order to be able to use the magic from the above code, we have to use the code below. Please note that the <code>src</code> attribute on the <code>&#x3C;video></code> element will be added automatically with the JavaScript code.</p>\n<p>1 - PugJS version</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"pug\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">video</span><span class=\"mtk1\">(</span><span class=\"mtk12\">preload</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;auto&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">playsinline</span><span class=\"mtk1\"> </span><span class=\"mtk12\">loop</span><span class=\"mtk1\"> </span><span class=\"mtk12\">muted</span><span class=\"mtk1\"> </span><span class=\"mtk12\">disablepictureinpicture</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">srcset</span><span class=\"mtk1\">=</span><span class=\"mtk8\">`</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    </span><span class=\"mtk4\">${</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">video_mobile</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk4\">}</span><span class=\"mtk8\"> 768w,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    </span><span class=\"mtk4\">${</span><span class=\"mtk12\">section</span><span class=\"mtk1\">.</span><span class=\"mtk12\">primary</span><span class=\"mtk1\">.</span><span class=\"mtk12\">video_desktop</span><span class=\"mtk1\">.</span><span class=\"mtk12\">url</span><span class=\"mtk4\">}</span><span class=\"mtk8\"> 769w</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">  `</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<p>2 - HTML version</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"html\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk17\">&lt;</span><span class=\"mtk4\">video</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">preload</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;auto&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">playsinline</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">loop</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">muted</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">disablepictureinpicture</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">srcset</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    https://media-creators.cdn.prismic.io/media-creators/85ff18ed-2238-4095-bdd6-ae19a6a5d502_pierre-sports__shop-product__mobile.mp4 768w, </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">    https://media-creators.cdn.prismic.io/media-creators/6cdb67a6-3fe0-4429-98b7-237c7c6aa84c_pierre-sports__shop-product%401920_lighter.mp4 769w</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">  &quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk17\">&gt;&lt;/</span><span class=\"mtk4\">video</span><span class=\"mtk17\">&gt;</span></span></span></code></pre>\n<h3>2.3 — Use an <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API\" target=\"_blank\" rel=\"noopener\">Intersection Observer</a> to <code>play()</code> the <code>&#x3C;video></code>when it is <em>only</em> visible on the screen</h3>\n<p>Here you can see the core concept idea using the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API\" target=\"_blank\" rel=\"noopener\">Intersection Observer API</a> to check if the <code>&#x3C;video></code> is currently visible on the user's screen.</p>\n<h4>2.3.1 — Code Example — Video plays only when is visible</h4>\n<pre class=\"grvsc-container default-dark\" data-language=\"js\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// Video.js</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Animation</span><span class=\"mtk1\"> </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;classes/Animation&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk4\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Animation</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">constructor</span><span class=\"mtk1\">({ </span><span class=\"mtk12\">element</span><span class=\"mtk1\"> }) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">super</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">element</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">animateIn</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">element</span><span class=\"mtk1\">?.</span><span class=\"mtk11\">play</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">animateOut</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">element</span><span class=\"mtk1\">?.</span><span class=\"mtk11\">pause</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h4>2.3.2 — Code Example — Animation JS <code>class</code> using the <code>window.IntersectionObserver</code> to make all the magic</h4>\n<p>Pay special attention to the <code>createObserver()</code> function and see how it works.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"js\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// Animation.js</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> </span><span class=\"mtk12\">AutoBind</span><span class=\"mtk1\"> </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;auto-bind&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">constructor</span><span class=\"mtk1\">({ </span><span class=\"mtk12\">element</span><span class=\"mtk1\">, </span><span class=\"mtk12\">elements</span><span class=\"mtk1\"> }) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">AutoBind</span><span class=\"mtk1\">(</span><span class=\"mtk4\">this</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">const</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">animationDelay</span><span class=\"mtk1\">, </span><span class=\"mtk12\">animationTarget</span><span class=\"mtk1\"> } = </span><span class=\"mtk12\">element</span><span class=\"mtk1\">.</span><span class=\"mtk12\">dataset</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">delay</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">animationDelay</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">element</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">element</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">elements</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">elements</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">target</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">animationTarget</span><span class=\"mtk1\"> ? </span><span class=\"mtk12\">element</span><span class=\"mtk1\">.</span><span class=\"mtk11\">closest</span><span class=\"mtk1\">(</span><span class=\"mtk12\">animationTarget</span><span class=\"mtk1\">) : </span><span class=\"mtk12\">element</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">isVisible</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">false</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk8\">&#39;IntersectionObserver&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk4\">in</span><span class=\"mtk1\"> </span><span class=\"mtk12\">window</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk11\">createObserver</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk11\">animateOut</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    } </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk11\">animateIn</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">createObserver</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">observer</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">window</span><span class=\"mtk1\">.</span><span class=\"mtk10\">IntersectionObserver</span><span class=\"mtk1\">((</span><span class=\"mtk12\">entries</span><span class=\"mtk1\">) </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">entries</span><span class=\"mtk1\">.</span><span class=\"mtk11\">forEach</span><span class=\"mtk1\">((</span><span class=\"mtk12\">entry</span><span class=\"mtk1\">) </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (!</span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">isVisible</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">entry</span><span class=\"mtk1\">.</span><span class=\"mtk12\">isIntersecting</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk11\">animateIn</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        } </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk11\">animateOut</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }).</span><span class=\"mtk11\">observe</span><span class=\"mtk1\">(</span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">target</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">animateIn</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">isVisible</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">true</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">animateOut</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">isVisible</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">false</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h2>3 — Web Animations (with CSS &#x26; JavaScript)</h2>\n<p>Web animations can be one of the hardest topics in performance. You can simply use CSS transitions and animations or mimic the same effect with JavaScript, but you will be able to take more advantage (performance-wise) and control when you combine these two technologies.</p>\n<p>JavaScript is great to detect when the animated elements are visible on the screen and to set <code>data-attributes</code> in these elements, to be able to control the animation state (show, hide or move elements). To achieve this goal, we must use an <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API\" target=\"_blank\" rel=\"noopener\">Intersection Observer</a> to check when the element is visible on the screen. Then, with CSS we can animate the desired elements.</p>\n<p>With the above approach, the browser will be able to generate much smoother animations, keeping the performance always in mind. When using CSS to animate the elements, instead of JavaScript, the browser gives a much higher FPS (Frames Per Second), comparing to the FPS obtained with JavaScript.</p>\n<p>We can also set different animations types or behavious for desktops, tablets or phones. Sometimes, the older phone models can have a very slow FPS; in this case, we can simply ignore specific animations with CSS and just let them run on \"high-performance\" devices. Please see point number <strong>4</strong> to see how this is possible.</p>\n<p>Now, let's take a look how we managed our animations at <a href=\"https://www.mediacreators.studio\" target=\"_blank\" rel=\"noopener\">www.mediacreators.studio</a> website</p>\n<h3>3.1 — CSS Base Animations</h3>\n<p>By using animated CSS <code>transform</code>, we can mimic the JavaScript behavior, but for that we have to add an extra class <code>.in-view</code>. You can see how in the point <strong>3.2</strong>.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"scss\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// animations.scss</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">*</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">span</span><span class=\"mtk1\"> </span><span class=\"mtk6\">span</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">transform</span><span class=\"mtk1\">: </span><span class=\"mtk11\">translateY</span><span class=\"mtk1\">(</span><span class=\"mtk7\">200%</span><span class=\"mtk1\">) </span><span class=\"mtk11\">rotateY</span><span class=\"mtk1\">(</span><span class=\"mtk7\">-20deg</span><span class=\"mtk1\">) </span><span class=\"mtk11\">rotateZ</span><span class=\"mtk1\">(</span><span class=\"mtk7\">20deg</span><span class=\"mtk1\">) </span><span class=\"mtk11\">skewX</span><span class=\"mtk1\">(</span><span class=\"mtk7\">30deg</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">transition</span><span class=\"mtk1\">: </span><span class=\"mtk8\">none</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">will-change</span><span class=\"mtk1\">: </span><span class=\"mtk12\">transform</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">&amp;</span><span class=\"mtk6\">.in-view</span><span class=\"mtk1\"> </span><span class=\"mtk6\">span</span><span class=\"mtk1\"> </span><span class=\"mtk6\">span</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">transform</span><span class=\"mtk1\">: </span><span class=\"mtk11\">translateY</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0%</span><span class=\"mtk1\">) </span><span class=\"mtk11\">rotateY</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0deg</span><span class=\"mtk1\">) </span><span class=\"mtk11\">rotateZ</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0deg</span><span class=\"mtk1\">) </span><span class=\"mtk11\">skewX</span><span class=\"mtk1\">(</span><span class=\"mtk7\">0deg</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">transition</span><span class=\"mtk1\">: </span><span class=\"mtk12\">transform</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1.4s</span><span class=\"mtk1\"> </span><span class=\"mtk12\">$ease-mc</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">[</span><span class=\"mtk6\">data-animation</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&#39;</span><span class=\"mtk1\">link</span><span class=\"mtk8\">&#39;</span><span class=\"mtk1\">] {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">display</span><span class=\"mtk1\">: </span><span class=\"mtk8\">inline-block</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">overflow</span><span class=\"mtk1\">: </span><span class=\"mtk8\">hidden</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">position</span><span class=\"mtk1\">: </span><span class=\"mtk8\">relative</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">white-space</span><span class=\"mtk1\">: </span><span class=\"mtk8\">nowrap</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">width</span><span class=\"mtk1\">: </span><span class=\"mtk8\">max-content</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">[</span><span class=\"mtk6\">data-animation</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&#39;</span><span class=\"mtk1\">link</span><span class=\"mtk8\">&#39;</span><span class=\"mtk1\">] </span><span class=\"mtk6\">span</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">display</span><span class=\"mtk1\">: </span><span class=\"mtk8\">inline-block</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">transform-origin</span><span class=\"mtk1\">: </span><span class=\"mtk8\">center</span><span class=\"mtk1\"> </span><span class=\"mtk8\">center</span><span class=\"mtk1\"> </span><span class=\"mtk7\">0.5em</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">vertical-align</span><span class=\"mtk1\">: </span><span class=\"mtk8\">middle</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">[</span><span class=\"mtk6\">data-animation</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&#39;</span><span class=\"mtk1\">label</span><span class=\"mtk8\">&#39;</span><span class=\"mtk1\">],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">[</span><span class=\"mtk6\">data-animation</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&#39;</span><span class=\"mtk1\">paragraph</span><span class=\"mtk8\">&#39;</span><span class=\"mtk1\">],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">[</span><span class=\"mtk6\">data-animation</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&#39;</span><span class=\"mtk1\">title</span><span class=\"mtk8\">&#39;</span><span class=\"mtk1\">],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">[</span><span class=\"mtk6\">data-animation</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&#39;</span><span class=\"mtk1\">chain</span><span class=\"mtk8\">&#39;</span><span class=\"mtk1\">] {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">span</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">display</span><span class=\"mtk1\">: </span><span class=\"mtk8\">inline-block</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">overflow</span><span class=\"mtk1\">: </span><span class=\"mtk8\">hidden</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">vertical-align</span><span class=\"mtk1\">: </span><span class=\"mtk8\">top</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3>3.2 — JavaScript exemplo of our <code>Title.js</code> animation</h3>\n<p>The <code>Title</code> animations are called via an HTML data-attribute: <code>data-animation=\"title\"</code>. This is how the animation is called via JS and CSS.</p>\n<p>Please pay attention to the <code>animateIn()</code> and <code>animateOut()</code> functions. You will see the following line: <code>classList.add('in-view')</code> and <code>classList.remove('in-view')</code>. Here is where the magic happens with the CSS animation.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"js\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Animation</span><span class=\"mtk1\"> </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;classes/Animation&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">import</span><span class=\"mtk1\"> { </span><span class=\"mtk12\">calculate</span><span class=\"mtk1\">, </span><span class=\"mtk12\">split</span><span class=\"mtk1\"> } </span><span class=\"mtk15\">from</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;utils/text&#39;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">export</span><span class=\"mtk1\"> </span><span class=\"mtk15\">default</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Title</span><span class=\"mtk1\"> </span><span class=\"mtk4\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Animation</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">constructor</span><span class=\"mtk1\">({ </span><span class=\"mtk12\">element</span><span class=\"mtk1\">, </span><span class=\"mtk12\">elements</span><span class=\"mtk1\"> }) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">super</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">element</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">elements</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">// divides the title into words, so we can animate each word individually</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">split</span><span class=\"mtk1\">({ </span><span class=\"mtk12\">element:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">element</span><span class=\"mtk1\">, </span><span class=\"mtk12\">append:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\"> });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk11\">split</span><span class=\"mtk1\">({ </span><span class=\"mtk12\">element:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">element</span><span class=\"mtk1\">, </span><span class=\"mtk12\">append:</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\"> });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">elementLinesSpans</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">element</span><span class=\"mtk1\">.</span><span class=\"mtk11\">querySelectorAll</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;span span&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">animateIn</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">element</span><span class=\"mtk1\">.</span><span class=\"mtk12\">classList</span><span class=\"mtk1\">.</span><span class=\"mtk11\">add</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;in-view&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">element</span><span class=\"mtk1\">.</span><span class=\"mtk11\">querySelectorAll</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;span span&#39;</span><span class=\"mtk1\">).</span><span class=\"mtk11\">forEach</span><span class=\"mtk1\">((</span><span class=\"mtk12\">element</span><span class=\"mtk1\">, </span><span class=\"mtk12\">index</span><span class=\"mtk1\">) </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">element</span><span class=\"mtk1\">.</span><span class=\"mtk12\">style</span><span class=\"mtk1\">.</span><span class=\"mtk12\">transitionDelay</span><span class=\"mtk1\"> = </span><span class=\"mtk8\">`</span><span class=\"mtk4\">${</span><span class=\"mtk12\">index</span><span class=\"mtk1\"> + </span><span class=\"mtk12\">index</span><span class=\"mtk1\"> + </span><span class=\"mtk12\">index</span><span class=\"mtk1\"> + </span><span class=\"mtk12\">index</span><span class=\"mtk4\">}</span><span class=\"mtk8\">0ms`</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">animateOut</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">element</span><span class=\"mtk1\">.</span><span class=\"mtk12\">classList</span><span class=\"mtk1\">.</span><span class=\"mtk11\">remove</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;in-view&#39;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">onResize</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">elementLines</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">calculate</span><span class=\"mtk1\">(</span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">elementLinesSpans</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h2>4 — Checking the Performance on all Devices (<code>low-performance</code> vs <code>high-performance</code>)</h2>\n<p>Performance is not just a matter in measuring the internet connection speed and serve the appropriated files or assets. To get a great performance on the overall experience, you must check if the user is on a <code>high-performance</code> or <code>low-performance</code> device. Then, according to the obtained result, we can show less animations, for example, or even don't show animations at all.</p>\n<h3>4.1 — Highjacking the scroll-bar</h3>\n<p>This performance check is very helpfull in case you are <em>hijacking</em> the scroll-bar with JavaScript.</p>\n<p>\"Highjacking the scroll-bar with JavaScript\" means that the website is not really scrolling, but instead, is the JavaScript that is moving the content shown on the screen, according to the user's scroll via the mouse input.</p>\n<h3>4.1.1 — Why Highjacking the scroll-bar?</h3>\n<p>Although hijacking the scroll-bar is considering a \"nightmare\" in user experience field, if you are like Nuno, who had used Windows computers for more than 15 years, you would also feel <em>extremely amazed</em> when you would open a website with a <em>smooth scroll-bar</em> behavior. Doesn't it feel <em>so good</em> when you would scroll your mouse wheel and the page would, somehow by magic, <em>smoothly slide</em> or <em>float</em> to a new section? This is certainly an ignored point for those users who were lucky enough to have Macintosh computers with those elite <em>Magic Mouses</em>, which would do this \"scrolling magic\" by default. <em>(For the record: Nuno has been using a Mac computer for the last 3 years and he really knows what he's talking about.)</em></p>\n<p>With all this in mind, is time now to avoid bad performance issues because of the \"smooth scroll-bar\" use. To achieve this, we will show bellow how we managed our performance test check. We will run a quick performance check to see if the user's device <strong>has at least 4 CPU-Cores</strong> and a class is added on the <code>html</code> element.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"js\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk11\">checkPerformance</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// Check Device&#39;s Performance</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">navigator</span><span class=\"mtk1\">.</span><span class=\"mtk12\">hardwareConcurrency</span><span class=\"mtk1\"> &lt;= </span><span class=\"mtk7\">4</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">navigator</span><span class=\"mtk1\">.</span><span class=\"mtk12\">userAgent</span><span class=\"mtk1\">.</span><span class=\"mtk11\">indexOf</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;Win&#39;</span><span class=\"mtk1\">) &gt; </span><span class=\"mtk7\">0</span><span class=\"mtk1\"> ?</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">document</span><span class=\"mtk1\">.</span><span class=\"mtk12\">documentElement</span><span class=\"mtk1\">.</span><span class=\"mtk12\">classList</span><span class=\"mtk1\">.</span><span class=\"mtk11\">add</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;low-performance&#39;</span><span class=\"mtk1\">) :</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">document</span><span class=\"mtk1\">.</span><span class=\"mtk12\">documentElement</span><span class=\"mtk1\">.</span><span class=\"mtk12\">classList</span><span class=\"mtk1\">.</span><span class=\"mtk11\">add</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;high-performance&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>After this check we can decide where to add a smooth scroll-bar behavior and where to avoid it.</p>\n<p><strong>All touch screens, special phone devices, have this smooth scroll-bar feature disabled</strong>, because of performance issues. The native scroll on touch devices is much better than any attempt made by JavaScript smooth scroll-bars.</p>\n<h3>4.1.2 — Controlling the scroll with the Keyboard</h3>\n<p>If we are \"highjacking\" the scroll-bar, we have to be able to let the user use his usual input methods to controll the scrolling of any web page.</p>\n<p>These input methods are:</p>\n<ul>\n<li><strong>Space bar</strong>: moves the page <strong>down</strong>, according to the height of the screen (for instance, 1080px);</li>\n<li><strong>Shift + Space bar</strong>: moves the page <strong>up</strong>, according to the height of the screen (for instance, 1080px);</li>\n<li><strong>Arrow key Down</strong>: moves the page <strong>down</strong>, but just a tiny bit;</li>\n<li><strong>Arrow key Up</strong>: moves the page <strong>up</strong>, but just a tiny bit;</li>\n</ul>\n<p>The last two methods, as they don't really have a default value defined. In our case, we devide the screen's height by 3, to be able to move just a \"tiny bit\" the page down/up, but still it's a higher value than the default's behavior. Here's the code line for that: <code>this.scroll.target = this.scroll.target + window.innerHeight / 3;</code></p>\n<pre class=\"grvsc-container default-dark\" data-language=\"js\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">elements</span><span class=\"mtk1\">.</span><span class=\"mtk12\">wrapper</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">/** Check for Key Presses */</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// check if keypress is outside of any input/textarea element first</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk12\">document</span><span class=\"mtk1\">.</span><span class=\"mtk12\">body</span><span class=\"mtk1\">.</span><span class=\"mtk11\">onkeydown</span><span class=\"mtk1\"> = (</span><span class=\"mtk12\">event</span><span class=\"mtk1\">) </span><span class=\"mtk4\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">// scroll down</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">event</span><span class=\"mtk1\">.</span><span class=\"mtk12\">target</span><span class=\"mtk1\">.</span><span class=\"mtk11\">matches</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;input&#39;</span><span class=\"mtk1\">) || </span><span class=\"mtk12\">event</span><span class=\"mtk1\">.</span><span class=\"mtk12\">target</span><span class=\"mtk1\">.</span><span class=\"mtk11\">matches</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;textarea&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        ? </span><span class=\"mtk4\">false</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        : </span><span class=\"mtk12\">event</span><span class=\"mtk1\">.</span><span class=\"mtk12\">key</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39; &#39;</span><span class=\"mtk1\"> &amp;&amp; !</span><span class=\"mtk12\">event</span><span class=\"mtk1\">.</span><span class=\"mtk12\">shiftKey</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">scroll</span><span class=\"mtk1\">.</span><span class=\"mtk12\">target</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">scroll</span><span class=\"mtk1\">.</span><span class=\"mtk12\">target</span><span class=\"mtk1\"> + </span><span class=\"mtk12\">window</span><span class=\"mtk1\">.</span><span class=\"mtk12\">innerHeight</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">// scroll up</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">event</span><span class=\"mtk1\">.</span><span class=\"mtk12\">target</span><span class=\"mtk1\">.</span><span class=\"mtk11\">matches</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;input&#39;</span><span class=\"mtk1\">) || </span><span class=\"mtk12\">event</span><span class=\"mtk1\">.</span><span class=\"mtk12\">target</span><span class=\"mtk1\">.</span><span class=\"mtk11\">matches</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;textarea&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        ? </span><span class=\"mtk4\">false</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        : </span><span class=\"mtk12\">event</span><span class=\"mtk1\">.</span><span class=\"mtk12\">key</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39; &#39;</span><span class=\"mtk1\"> &amp;&amp; </span><span class=\"mtk12\">event</span><span class=\"mtk1\">.</span><span class=\"mtk12\">shiftKey</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">scroll</span><span class=\"mtk1\">.</span><span class=\"mtk12\">target</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">scroll</span><span class=\"mtk1\">.</span><span class=\"mtk12\">target</span><span class=\"mtk1\"> - </span><span class=\"mtk12\">window</span><span class=\"mtk1\">.</span><span class=\"mtk12\">innerHeight</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">event</span><span class=\"mtk1\">.</span><span class=\"mtk12\">target</span><span class=\"mtk1\">.</span><span class=\"mtk11\">matches</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;input&#39;</span><span class=\"mtk1\">) || </span><span class=\"mtk12\">event</span><span class=\"mtk1\">.</span><span class=\"mtk12\">target</span><span class=\"mtk1\">.</span><span class=\"mtk11\">matches</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;textarea&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        ? </span><span class=\"mtk4\">false</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        : </span><span class=\"mtk12\">event</span><span class=\"mtk1\">.</span><span class=\"mtk12\">key</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39;ArrowDown&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">scroll</span><span class=\"mtk1\">.</span><span class=\"mtk12\">target</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">scroll</span><span class=\"mtk1\">.</span><span class=\"mtk12\">target</span><span class=\"mtk1\"> + </span><span class=\"mtk12\">window</span><span class=\"mtk1\">.</span><span class=\"mtk12\">innerHeight</span><span class=\"mtk1\"> / </span><span class=\"mtk7\">3</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk12\">event</span><span class=\"mtk1\">.</span><span class=\"mtk12\">target</span><span class=\"mtk1\">.</span><span class=\"mtk11\">matches</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;input&#39;</span><span class=\"mtk1\">) || </span><span class=\"mtk12\">event</span><span class=\"mtk1\">.</span><span class=\"mtk12\">target</span><span class=\"mtk1\">.</span><span class=\"mtk11\">matches</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&#39;textarea&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        ? </span><span class=\"mtk4\">false</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        : </span><span class=\"mtk12\">event</span><span class=\"mtk1\">.</span><span class=\"mtk12\">key</span><span class=\"mtk1\"> === </span><span class=\"mtk8\">&#39;ArrowUp&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    ) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">scroll</span><span class=\"mtk1\">.</span><span class=\"mtk12\">target</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">scroll</span><span class=\"mtk1\">.</span><span class=\"mtk12\">target</span><span class=\"mtk1\"> - </span><span class=\"mtk12\">window</span><span class=\"mtk1\">.</span><span class=\"mtk12\">innerHeight</span><span class=\"mtk1\"> / </span><span class=\"mtk7\">3</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  };</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">elements</span><span class=\"mtk1\">.</span><span class=\"mtk12\">wrapper</span><span class=\"mtk1\">.</span><span class=\"mtk12\">style</span><span class=\"mtk1\">[</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">transformPrefix</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  ] = </span><span class=\"mtk8\">`translate3d(0, -</span><span class=\"mtk4\">${</span><span class=\"mtk10\">Math</span><span class=\"mtk1\">.</span><span class=\"mtk11\">floor</span><span class=\"mtk1\">(</span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">scroll</span><span class=\"mtk1\">.</span><span class=\"mtk12\">current</span><span class=\"mtk1\">)</span><span class=\"mtk4\">}</span><span class=\"mtk8\">px, 0)`</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">elements</span><span class=\"mtk1\">.</span><span class=\"mtk12\">wrapper</span><span class=\"mtk1\">.</span><span class=\"mtk12\">style</span><span class=\"mtk1\">.</span><span class=\"mtk12\">willChange</span><span class=\"mtk1\"> = </span><span class=\"mtk8\">`transform`</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>Please note that we are using the CSS <code>translate3d()</code> method to force the page to be move via the GPU instead of the CPU. This is a much better benefit for the user, because the scroll is handled by the GPU, while the CPU is already busy handling all the necessary JavaScript to run the page.</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .default-dark .mtk3 { color: #6A9955; }\n  .default-dark .mtk4 { color: #569CD6; }\n  .default-dark .mtk1 { color: #D4D4D4; }\n  .default-dark .mtk12 { color: #9CDCFE; }\n  .default-dark .mtk8 { color: #CE9178; }\n  .default-dark .mtk15 { color: #C586C0; }\n  .default-dark .mtk11 { color: #DCDCAA; }\n  .default-dark .mtk7 { color: #B5CEA8; }\n  .default-dark .mtk10 { color: #4EC9B0; }\n  .default-dark .mtk5 { color: #D16969; }\n  .default-dark .mtk6 { color: #D7BA7D; }\n  .default-dark .mtk17 { color: #808080; }\n  .default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","frontmatter":{"date":"April 21, 2022","title":"Code Examples of the Media Creators (NodeJS) website\n","description":"Here is shown a few precious pieces of code, to help in the near future, when no one knows what this all is about.\n","tags":["Image Optimization","Internet Connections","JavaScript","NodeJS","Performance","Prismic.io","PugJS","Usability","User Experience","Video","Web Development"]}}},"pageContext":{"id":"f708efa8-62b3-5218-a6bb-8cdd65756c9d"}},
    "staticQueryHashes": ["4080856488"]}